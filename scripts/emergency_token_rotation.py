#!/usr/bin/env python3
"""
üö® –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò üö®

–¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ –±—ã–ª –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤ –ø—É–±–ª–∏—á–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub!
–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–º–µ–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω.

–ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø:
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ @BotFather
2. –û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
"""

import os
import requests
import asyncio
import sys
from datetime import datetime

def print_security_warning():
    """–í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
    print("=" * 80)
    print("üö® –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò üö®")
    print("=" * 80)
    print("–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —É—Ç–µ—á–∫–∞ —Ç–æ–∫–µ–Ω–∞ Telegram –±–æ—Ç–∞ –≤ –ø—É–±–ª–∏—á–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!")
    print("GitHub Security Alert: Publicly leaked secret")
    print("–í—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:", datetime.now().strftime("%Y-%m-%d %H:%M:%S"))
    print()
    print("–°–ö–û–ú–ü–†–û–ú–ï–¢–ò–†–û–í–ê–ù–ù–´–ô –¢–û–ö–ï–ù –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ó–ê–ú–ï–ù–ï–ù!")
    print("=" * 80)
    print()

def get_instructions():
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏"""
    return """
–ü–û–®–ê–ì–û–í–´–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –†–û–¢–ê–¶–ò–ò –¢–û–ö–ï–ù–ê:

1. üîë –°–û–ó–î–ê–ô–¢–ï –ù–û–í–´–ô –¢–û–ö–ï–ù:
   - –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
   - –ù–∞–π–¥–∏—Ç–µ @BotFather
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ /mybots
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
   - –ù–∞–∂–º–∏—Ç–µ "API Token"
   - –ù–∞–∂–º–∏—Ç–µ "Revoke current token" (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω

2. üåê –û–ë–ù–û–í–ò–¢–ï RENDER.COM:
   - –í–æ–π–¥–∏—Ç–µ –≤ https://dashboard.render.com
   - –ù–∞–π–¥–∏—Ç–µ —Å–µ—Ä–≤–∏—Å target-ai
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Environment
   - –û–±–Ω–æ–≤–∏—Ç–µ TELEGRAM_BOT_TOKEN
   - –ù–∞–∂–º–∏—Ç–µ Save Changes

3. üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:
   - –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python test_new_token.py
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–æ—Ç–∞ –≤ Telegram

4. üìä –ü–†–û–í–ï–†–ö–ê –õ–û–ì–û–í:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Render.com
   - –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–æ—Ç–∞
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

5. üîí –ó–ê–ö–†–û–ô–¢–ï ALERT:
   - –í GitHub –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Security > Secret scanning alerts
   - –ù–∞–π–¥–∏—Ç–µ alert —Å —Ç–æ–∫–µ–Ω–æ–º
   - –ù–∞–∂–º–∏—Ç–µ "Close as revoked"
"""

def check_old_token_status():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Å—Ç–∞—Ä–æ–≥–æ (—Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ) —Ç–æ–∫–µ–Ω–∞"""
    old_token = "8137758490:AAH3bH4Rwvq5CJPxQNtn_VN-2-eKujSqW8o"
    
    print("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞...")
    
    try:
        response = requests.get(f"https://api.telegram.org/bot{old_token}/getMe", timeout=10)
        if response.status_code == 200:
            print("‚ùå –û–ü–ê–°–ù–û–°–¢–¨: –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –í–°–Å –ï–©–Å –ê–ö–¢–ò–í–ï–ù!")
            print("   –ù–ï–ú–ï–î–õ–ï–ù–ù–û –æ—Ç–∑–æ–≤–∏—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ @BotFather!")
            return False
        else:
            print("‚úÖ –•–æ—Ä–æ—à–æ: –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω –∏–ª–∏ –æ—Ç–æ–∑–≤–∞–Ω")
            return True
    except Exception as e:
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω: {e}")
        return None

def check_new_token():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è"""
    new_token = os.getenv('TELEGRAM_BOT_TOKEN')
    
    if not new_token:
        print("‚ùå –ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è")
        return False
    
    if new_token == "8137758490:AAH3bH4Rwvq5CJPxQNtn_VN-2-eKujSqW8o":
        print("‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω!")
        return False
    
    print(f"üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ (***{new_token[-10:]})...")
    
    try:
        response = requests.get(f"https://api.telegram.org/bot{new_token}/getMe", timeout=10)
        if response.status_code == 200:
            bot_info = response.json()['result']
            print(f"‚úÖ –ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")
            print(f"   –ë–æ—Ç: @{bot_info['username']} ({bot_info['first_name']})")
            return True
        else:
            print(f"‚ùå –ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: {response.status_code}")
            return False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞: {e}")
        return False

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print_security_warning()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —Å—Ç–∞—Ä–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
    old_token_revoked = check_old_token_status()
    print()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
    new_token_works = check_new_token()
    print()
    
    # –í—ã–≤–æ–¥–∏–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    print(get_instructions())
    
    # –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
    print("=" * 80)
    print("üìä –ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–° –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò:")
    print("=" * 80)
    
    if old_token_revoked and new_token_works:
        print("‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê!")
        print("   - –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –æ—Ç–æ–∑–≤–∞–Ω")
        print("   - –ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç")
        print("   - –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å GitHub Security Alert")
    elif old_token_revoked is False:
        print("üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨!")
        print("   - –°—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –í–°–Å –ï–©–Å –ê–ö–¢–ò–í–ï–ù!")
        print("   - –ù–ï–ú–ï–î–õ–ï–ù–ù–û –æ—Ç–∑–æ–≤–∏—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ @BotFather!")
    elif not new_token_works:
        print("‚ö†Ô∏è –ù–û–í–´–ô –¢–û–ö–ï–ù –ù–ï –ù–ê–°–¢–†–û–ï–ù!")
        print("   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω")
        print("   - –û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è")
    else:
        print("‚è≥ –†–û–¢–ê–¶–ò–Ø –í –ü–†–û–¶–ï–°–°–ï...")
        print("   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤—ã—à–µ")
    
    print("=" * 80)

if __name__ == "__main__":
    main()
